import React, {useState, useEffect} from 'react';

import {
  Easing,
  StyleSheet,
  View,
  Dimensions,
  Text,
  Switch,
  Image,
} from 'react-native';
import MapboxGL from '@react-native-mapbox-gl/maps';
import RadioButton from '../UI/RadioButton';
import geoViewport from '@mapbox/geo-viewport';
import * as Progress from 'react-native-progress';
import geo from '../../data/geo';
MapboxGL.setAccessToken(
  'sk.eyJ1IjoiYXZ2YWt1bW92aWQiLCJhIjoiY2wyMGQ0M2JhMHZrdDNkbnJpOTh4YXpmdyJ9.pqVM1LvwnKEatZAT-CR6Yw',
);

const Map = () => {
  const [mapEnabled, setMapEnabled] = useState(true);
  const [coordinates, setCoordinates] = useState([36.81837, 55.710085]);
  const [procent, setProcent] = useState(0);
  const [routeName, setRouteName] = useState('');
  const [route, setRoute] = useState({
    type: 'FeatureCollection',
    features: [
      {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'LineString',
          coordinates: [],
          // coordinates: [
          //   [36.81837, 55.710085],
          //   [36.81877, 55.71055],
          //   [36.819, 55.710818],
          //   [36.819189, 55.71104],
          //   [36.819229, 55.711081],
          //   [36.820071, 55.712058],
          //   [36.820265, 55.712331],
          //   [36.820618, 55.712903],
          //   [36.820686, 55.713007],
          //   [36.820707, 55.713036],
          //   [36.821113, 55.713635],
          //   [36.821158, 55.713701],
          //   [36.821271, 55.713874],
          //   [36.821792, 55.714678],
          //   [36.821851, 55.714764],
          //   [36.822172, 55.71524],
          //   [36.822279, 55.715406],
          //   [36.822607, 55.715859],
          //   [36.822759, 55.716063],
          //   [36.82288, 55.716225],
          //   [36.823, 55.716366],
          //   [36.82318, 55.716506],
          //   [36.82341, 55.716669],
          //   [36.823714, 55.71684],
          //   [36.824223, 55.717137],
          //   [36.825288, 55.717774],
          //   [36.825665, 55.717987],
          //   [36.825841, 55.718092],
          //   [36.826959, 55.718758],
          //   [36.827774, 55.71923],
          //   [36.828547, 55.719678],
          //   [36.829492, 55.720226],
          //   [36.830825, 55.721013],
          //   [36.831175, 55.72122],
          //   [36.831989, 55.721708],
          //   [36.834652, 55.723289],
          //   [36.837178, 55.72471],
          //   [36.838188, 55.725235],
          //   [36.838724, 55.724965],
          //   [36.83926, 55.724656],
          //   [36.839352, 55.724625],
          //   [36.839441, 55.724608],
          //   [36.839495, 55.724607],
          //   [36.839542, 55.724611],
          //   [36.839628, 55.72463],
          //   [36.839726, 55.724667],
          //   [36.839847, 55.724732],
          //   [36.841215, 55.72558],
          //   [36.841365, 55.725677],
          //   [36.841407, 55.7257],
          //   [36.841714, 55.725874],
          //   [36.842047, 55.726059],
          //   [36.84229, 55.726158],
          //   [36.842581, 55.726267],
          //   [36.842941, 55.726364],
          //   [36.843064, 55.726389],
          //   [36.843305, 55.726438],
          //   [36.843792, 55.726524],
          //   [36.844493, 55.726608],
          //   [36.845176, 55.726674],
          //   [36.845387, 55.726695],
          //   [36.845926, 55.726752],
          //   [36.846645, 55.726843],
          //   [36.847127, 55.726926],
          //   [36.847599, 55.727049],
          //   [36.847967, 55.727186],
          //   [36.848827, 55.727544],
          //   [36.849279, 55.727733],
          //   [36.851478, 55.728645],
          //   [36.851762, 55.72876],
          //   [36.85189, 55.728837],
          //   [36.852148, 55.729022],
          //   [36.852429, 55.729436],
          //   [36.852541, 55.729703],
          //   [36.852584, 55.72973],
          //   [36.852682, 55.729769],
          //   [36.852796, 55.729799],
          //   [36.85295, 55.729804],
          //   [36.854251, 55.729644],
          //   [36.855084, 55.729543],
          //   [36.855179, 55.729533],
          // ],
        },
      },
    ],
  });
  const [road, setRoad] = useState({
    type: 'FeatureCollection',
    features: [
      {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'LineString',
          coordinates: [
            [36.816301345825195, 55.70859366920591],
            [36.814584732055664, 55.711204870389906],
            [36.80952072143555, 55.71299392600409],
            [36.803083419799805, 55.714686200504104],
            [36.79673194885254, 55.716378401695174],
            [36.79475784301758, 55.71681352729539],
            [36.79694652557373, 55.71867484320059],
            [36.79866313934326, 55.72010098627635],
            [36.797633171081536, 55.721647930052676],
            [36.80059432983398, 55.72159958898716],
            [36.802310943603516, 55.71913411529964],
            [36.80540084838867, 55.71898908258864],
            [36.80900573730469, 55.71976258415723],
          ],
        },
      },
    ],
  });
  useEffect(() => {
    if (procent === 100) {
      setMapEnabled(true);
    }
    console.log(geo.type);
  }, [procent]);
  const downloadOfflineMapOnRoute = async (name, coordinates, route) => {
    let pack = await MapboxGL.offlineManager.getPack(name);
    console.log(name, coordinates, pack);
    if (!pack) {
      setMapEnabled(false);
      creatPack(name, coordinates);
    }
    setCoordinates(coordinates);
    setRoute(route);
  };

  const renderRoadDirections = (route) => {
    return route ? (
      <MapboxGL.ShapeSource id="routeSource" shape={route}>
        <MapboxGL.LineLayer
          id="routeFill"
          style={{lineColor: 'blue', lineWidth: 3.2, lineOpacity: 1.84}}
        />
      </MapboxGL.ShapeSource>
    ) : null;
  };
  const renderRoad = (route) => {
    return route ? (
      <MapboxGL.ShapeSource id="Road" shape={route}>
        <MapboxGL.LineLayer
          id="routeFillD"
          style={{lineColor: '#008000', lineWidth: 3.2, lineOpacity: 1.84}}
        />
      </MapboxGL.ShapeSource>
    ) : null;
  };

  const progressListener = (offlineRegion, status) =>
    setProcent(Math.floor(status.percentage));
  const errorListener = (offlineRegion, err) => console.log(offlineRegion, err);

  const creatPack = async (name, centerCoord) => {
    const MAPBOX_VECTOR_TILE_SIZE = 512;
    const {width, height} = Dimensions.get('window');
    const bounds = geoViewport.bounds(
      centerCoord,
      12,
      [width, height],
      MAPBOX_VECTOR_TILE_SIZE,
    );
    const options = {
      name: name,
      styleURL: MapboxGL.StyleURL.Street,
      bounds: [
        [bounds[0], bounds[1]],
        [bounds[2], bounds[3]],
      ],
      minZoom: 10,
      maxZoom: 20,
    };
    await MapboxGL.offlineManager.createPack(options, progressListener);
  };
  const getPack = () => {
    MapboxGL.offlineManager.getPacks().then((resp) => {
      console.log('resp', resp[0].pack);
    });
    // MapboxGL.offlineManager.invalidatePack('OfflinePack122').then((resp) => {
    //   console.log('invalidatePack', resp);
    // });
  };

  // const toggleSwitch = () =>
  const [isEnabled, setIsEnabled] = useState(false);
  const toggleSwitch = () => setMapEnabled((previousState) => !previousState);
  return (
    <View style={styles.page}>
      <View style={styles.container}>
        <RadioButton
          prop={PROP}
          downloadOfflineMapOnRoute={downloadOfflineMapOnRoute}
        />
        {!(procent === 0 || procent === 100) ? (
          <View
            style={{
              flexDirection: 'row',
              alignItems: 'center',
              justifyContent: 'space-around',
            }}
          >
            <Progress.Bar
              color={'grey'}
              progress={parseInt(procent) * 0.01}
              width={300}
            />
            <Text>{procent} %</Text>
            <Switch
              trackColor={{false: '#767577', true: '#99FF66'}}
              thumbColor={!mapEnabled ? '#f4f3f4' : '#f4f3f4'}
              ios_backgroundColor="#3e3e3e"
              onValueChange={toggleSwitch}
              value={!mapEnabled}
            />
          </View>
        ) : null}

        <MapboxGL.MapView
          userTrackingMode={1}
          style={styles.map}
          attributionPosition={{bottom: 10, left: 10}}
          logoEnabled={false}
          showUserLocation={true}
          surfaceView={true}
          scrollEnabled={mapEnabled}
          zoomEnabled={mapEnabled}
          rotateEnabled={mapEnabled}
          onPress={(feature) => {
            console.log('Coords:', feature);
            // setCoordinates(feature.geometry.coordinates)
          }}
        >
          <MapboxGL.UserLocation renderMode={'native'} visible={true} />
          {renderRoadDirections(route)}
          {renderRoad(geo)}
          {pointsAnnotationCreate(geo)}
          {/* <MapboxGL.CircleLayer /> */}
          <MapboxGL.PointAnnotation
            key={'123123'}
            id={'123123'}
            coordinate={[-117.20611157485, 52.180961084261]}
            title="sad"
          />
        </MapboxGL.MapView>
      </View>
    </View>
  );
};
const styles = StyleSheet.create({
  icon: {
    iconSize: 1,
    iconImage: 'dot-11',
    iconColor: '#ff0011',
    iconHaloColor: 'rgba(0, 255, 0, 0)',
  },
  page: {
    flex: 1,
  },
  container: {
    height: '100%',
    width: '100%',
    flex: 1,
  },
  map: {
    flex: 1,
  },
});

const PROP = [
  {
    id: 1,
    route: {
      type: 'FeatureCollection',
      features: [
        {
          type: 'Feature',
          properties: {},
          geometry: {
            type: 'LineString',
            coordinates: [
              [36.81837, 55.710085],
              [36.81877, 55.71055],
              [36.819, 55.710818],
              [36.819189, 55.71104],
              [36.819229, 55.711081],
              [36.820071, 55.712058],
              [36.820265, 55.712331],
              [36.820618, 55.712903],
              [36.820686, 55.713007],
              [36.820707, 55.713036],
              [36.821113, 55.713635],
              [36.821158, 55.713701],
              [36.821271, 55.713874],
              [36.821792, 55.714678],
              [36.821851, 55.714764],
              [36.822172, 55.71524],
              [36.822279, 55.715406],
              [36.822607, 55.715859],
              [36.822759, 55.716063],
              [36.82288, 55.716225],
              [36.823, 55.716366],
              [36.82318, 55.716506],
              [36.82341, 55.716669],
              [36.823714, 55.71684],
              [36.824223, 55.717137],
              [36.825288, 55.717774],
              [36.825665, 55.717987],
              [36.825841, 55.718092],
              [36.826959, 55.718758],
              [36.827774, 55.71923],
              [36.828547, 55.719678],
              [36.829492, 55.720226],
              [36.830825, 55.721013],
              [36.831175, 55.72122],
              [36.831989, 55.721708],
              [36.834652, 55.723289],
              [36.837178, 55.72471],
              [36.838188, 55.725235],
              [36.838724, 55.724965],
              [36.83926, 55.724656],
              [36.839352, 55.724625],
              [36.839441, 55.724608],
              [36.839495, 55.724607],
              [36.839542, 55.724611],
              [36.839628, 55.72463],
              [36.839726, 55.724667],
              [36.839847, 55.724732],
              [36.841215, 55.72558],
              [36.841365, 55.725677],
              [36.841407, 55.7257],
              [36.841714, 55.725874],
              [36.842047, 55.726059],
              [36.84229, 55.726158],
              [36.842581, 55.726267],
              [36.842941, 55.726364],
              [36.843064, 55.726389],
              [36.843305, 55.726438],
              [36.843792, 55.726524],
              [36.844493, 55.726608],
              [36.845176, 55.726674],
              [36.845387, 55.726695],
              [36.845926, 55.726752],
              [36.846645, 55.726843],
              [36.847127, 55.726926],
              [36.847599, 55.727049],
              [36.847967, 55.727186],
              [36.848827, 55.727544],
              [36.849279, 55.727733],
              [36.851478, 55.728645],
              [36.851762, 55.72876],
              [36.85189, 55.728837],
              [36.852148, 55.729022],
              [36.852429, 55.729436],
              [36.852541, 55.729703],
              [36.852584, 55.72973],
              [36.852682, 55.729769],
              [36.852796, 55.729799],
              [36.85295, 55.729804],
              [36.854251, 55.729644],
              [36.855084, 55.729543],
              [36.855179, 55.729533],
            ],
          },
        },
      ],
    },
    name: 'Zvenigorod',
  },
  {
    id: 2,
    route: {
      type: 'FeatureCollection',
      features: [
        {
          type: 'Feature',
          properties: {},
          geometry: {
            type: 'LineString',
            coordinates: [
              [65.558151, 57.15191],
              [65.557037, 57.151327],
              [65.55684, 57.151208],
              [65.555698, 57.150592],
              [65.555383, 57.150395],
              [65.555295, 57.150344],
              [65.555588, 57.150184],
              [65.55585, 57.150044],
              [65.555947, 57.149989],
              [65.556339, 57.149777],
              [65.556463, 57.149709],
              [65.556556, 57.149664],
              [65.556714, 57.149595],
              [65.557131, 57.149422],
              [65.557347, 57.149331],
              [65.557951, 57.148921],
              [65.55807, 57.14881],
              [65.558507, 57.148401],
              [65.559081, 57.148069],
              [65.559883, 57.147672],
              [65.559995, 57.147615],
              [65.559244, 57.147197],
              [65.559192, 57.147167],
              [65.558577, 57.146816],
              [65.557631, 57.146278],
              [65.557082, 57.145981],
              [65.556579, 57.145709],
              [65.555744, 57.145246],
              [65.555625, 57.145175],
              [65.555782, 57.145094],
              [65.556006, 57.144977],
              [65.556446, 57.144747],
              [65.556889, 57.144517],
              [65.557108, 57.144402],
              [65.557665, 57.144115],
              [65.55774, 57.14408],
              [65.559265, 57.143282],
              [65.559396, 57.143212],
              [65.560097, 57.142841],
              [65.560663, 57.142541],
              [65.561122, 57.142298],
              [65.561937, 57.141867],
              [65.562177, 57.14174],
              [65.562437, 57.141602],
              [65.562788, 57.141417],
              [65.563558, 57.141009],
              [65.564539, 57.140489],
              [65.565393, 57.140038],
              [65.566718, 57.139337],
              [65.567472, 57.138939],
              [65.56805, 57.138633],
              [65.568929, 57.138169],
              [65.569129, 57.138068],
              [65.568922, 57.137949],
              [65.56821, 57.137535],
              [65.567454, 57.13708],
              [65.566972, 57.136809],
              [65.566817, 57.136721],
              [65.5668, 57.136708],
              [65.566461, 57.136458],
              [65.566258, 57.136225],
              [65.565236, 57.134778],
              [65.565143, 57.134647],
              [65.565061, 57.134531],
              [65.564769, 57.134073],
              [65.564534, 57.133785],
              [65.564364, 57.133627],
              [65.563886, 57.133231],
              [65.562469, 57.132145],
              [65.560557, 57.130677],
              [65.55993, 57.130211],
              [65.559535, 57.1299],
              [65.559452, 57.129839],
              [65.558989, 57.129513],
              [65.558408, 57.129088],
              [65.557899, 57.128715],
              [65.55748, 57.128404],
              [65.556414, 57.127576],
              [65.554847, 57.126398],
              [65.554187, 57.125913],
              [65.553824, 57.125625],
              [65.553382, 57.125293],
              [65.552356, 57.124524],
              [65.552134, 57.124421],
              [65.551994, 57.12434],
              [65.551721, 57.124152],
              [65.549534, 57.122521],
              [65.548678, 57.121879],
              [65.547963, 57.121369],
              [65.547842, 57.121303],
              [65.547722, 57.121262],
              [65.547341, 57.121176],
              [65.547239, 57.121151],
              [65.547145, 57.121117],
              [65.547042, 57.121063],
              [65.546962, 57.120998],
              [65.546909, 57.120925],
              [65.546884, 57.120848],
              [65.54689, 57.12077],
              [65.546919, 57.120704],
              [65.546973, 57.120638],
              [65.547051, 57.120578],
              [65.547148, 57.120528],
              [65.547261, 57.120489],
              [65.547368, 57.120455],
              [65.547496, 57.120439],
              [65.547673, 57.12043],
              [65.547848, 57.120463],
              [65.547981, 57.120517],
              [65.548081, 57.12057],
              [65.548157, 57.120625],
              [65.548224, 57.120701],
              [65.548258, 57.120783],
              [65.548285, 57.120875],
              [65.548254, 57.120934],
              [65.548326, 57.121038],
              [65.548394, 57.121119],
              [65.54847, 57.121198],
              [65.548882, 57.121502],
              [65.549964, 57.12233],
              [65.550024, 57.122375],
              [65.550507, 57.12274],
              [65.551713, 57.123711],
              [65.552362, 57.12421],
              [65.552455, 57.124303],
              [65.552502, 57.124382],
              [65.553059, 57.124149],
              [65.553479, 57.123974],
              [65.553978, 57.123776],
              [65.55463, 57.123529],
              [65.555794, 57.123078],
              [65.556226, 57.122912],
              [65.556977, 57.122594],
              [65.556882, 57.122494],
              [65.556584, 57.122259],
              [65.555999, 57.12179],
              [65.555826, 57.121671],
              [65.555717, 57.121584],
            ],
          },
        },
      ],
    },
    name: 'Tyumen',
  },
  {
    id: 3,
    route: {
      type: 'FeatureCollection',
      features: [
        {
          type: 'Feature',
          properties: {},
          geometry: {
            type: 'LineString',
            coordinates: [
              [30.30107, 59.936453],
              [30.300972, 59.93652],
              [30.303639, 59.937468],
              [30.303739, 59.937503],
              [30.304232, 59.937684],
              [30.304789, 59.937897],
              [30.306108, 59.938401],
              [30.30745, 59.938917],
              [30.30851, 59.939324],
              [30.30881, 59.939449],
              [30.309597, 59.939754],
              [30.309739, 59.939825],
              [30.30984, 59.939897],
              [30.309957, 59.940027],
              [30.310008, 59.940086],
              [30.310065, 59.940137],
              [30.310155, 59.940187],
              [30.31084, 59.940436],
              [30.311027, 59.940515],
              [30.312764, 59.941147],
              [30.314495, 59.941778],
              [30.315088, 59.942],
              [30.316065, 59.942342],
              [30.316775, 59.942546],
              [30.316818, 59.942564],
              [30.316854, 59.942584],
              [30.317052, 59.942657],
              [30.317927, 59.942982],
              [30.318954, 59.943363],
              [30.320837, 59.943917],
              [30.32095, 59.943951],
              [30.325493, 59.945277],
              [30.327029, 59.945722],
              [30.327146, 59.945719],
              [30.3291, 59.946153],
              [30.329275, 59.946195],
              [30.329446, 59.946234],
              [30.329533, 59.946254],
              [30.329647, 59.946281],
              [30.329704, 59.946294],
              [30.329935, 59.946346],
              [30.330092, 59.946381],
              [30.331877, 59.94678],
              [30.332011, 59.946812],
              [30.332057, 59.946859],
              [30.332247, 59.946902],
              [30.332455, 59.946945],
              [30.33296, 59.947035],
              [30.333921, 59.947251],
              [30.335599, 59.947626],
              [30.335902, 59.947714],
              [30.33615, 59.947763],
              [30.336794, 59.947903],
              [30.33686, 59.94792],
              [30.336914, 59.947914],
              [30.337116, 59.947954],
              [30.33988, 59.948594],
              [30.34092, 59.948824],
              [30.341182, 59.948873],
              [30.341457, 59.948918],
              [30.342783, 59.949062],
              [30.34598, 59.949408],
              [30.346249, 59.949445],
              [30.346961, 59.949551],
              [30.348477, 59.949811],
              [30.34867, 59.949834],
              [30.349048, 59.949878],
              [30.349393, 59.949919],
              [30.349644, 59.949948],
              [30.350342, 59.950002],
              [30.350837, 59.950027],
              [30.351211, 59.950034],
              [30.351738, 59.950032],
              [30.352602, 59.949978],
              [30.353405, 59.949938],
              [30.354366, 59.949905],
              [30.354695, 59.94989],
              [30.355576, 59.949854],
              [30.356008, 59.949836],
              [30.359156, 59.949704],
              [30.35933, 59.949697],
              [30.359612, 59.949689],
              [30.359735, 59.949685],
              [30.360741, 59.949678],
              [30.363266, 59.949654],
              [30.364418, 59.949684],
              [30.365354, 59.949744],
              [30.366754, 59.949904],
              [30.367947, 59.950068],
              [30.368099, 59.95009],
              [30.368292, 59.950119],
              [30.368807, 59.950228],
              [30.36972, 59.95042],
              [30.370961, 59.950705],
              [30.371626, 59.950861],
              [30.372232, 59.951021],
              [30.372881, 59.951191],
              [30.374347, 59.951666],
              [30.377386, 59.952654],
              [30.379228, 59.953316],
              [30.379981, 59.95362],
              [30.384238, 59.955528],
              [30.384665, 59.955712],
              [30.38514, 59.95587],
              [30.385623, 59.955997],
              [30.386127, 59.956101],
              [30.386645, 59.956174],
              [30.387162, 59.956218],
              [30.387619, 59.956234],
              [30.388068, 59.956233],
              [30.388537, 59.956217],
              [30.389036, 59.956168],
              [30.389485, 59.956105],
              [30.389962, 59.95601],
              [30.390811, 59.955765],
              [30.394677, 59.95431],
              [30.395036, 59.954143],
              [30.39582, 59.953779],
              [30.397541, 59.952821],
              [30.397879, 59.952594],
              [30.398191, 59.952367],
              [30.398794, 59.95183],
              [30.399076, 59.95152],
              [30.39922, 59.951353],
              [30.399368, 59.951129],
              [30.39961, 59.950715],
              [30.399768, 59.950326],
              [30.399897, 59.949858],
              [30.399945, 59.9495],
              [30.399958, 59.949235],
              [30.399926, 59.948965],
              [30.399843, 59.948561],
              [30.399654, 59.948077],
              [30.398124, 59.944428],
              [30.397759, 59.943461],
              [30.397657, 59.942954],
              [30.397608, 59.942553],
              [30.397558, 59.941261],
              [30.39756, 59.941121],
              [30.397493, 59.940819],
              [30.397379, 59.940496],
              [30.397305, 59.940346],
              [30.397225, 59.940269],
              [30.397082, 59.939941],
              [30.396975, 59.939724],
              [30.396572, 59.938945],
              [30.396497, 59.93881],
              [30.396398, 59.938629],
              [30.396236, 59.938384],
              [30.395894, 59.93789],
              [30.39571, 59.937627],
              [30.395581, 59.937467],
              [30.395152, 59.937061],
              [30.394335, 59.936286],
              [30.393255, 59.935265],
              [30.392358, 59.93442],
              [30.391905, 59.934015],
              [30.391677, 59.933809],
              [30.390473, 59.93272],
              [30.390315, 59.932536],
              [30.390159, 59.932324],
              [30.390005, 59.932064],
              [30.389796, 59.931603],
              [30.389704, 59.931411],
              [30.389521, 59.930985],
              [30.389175, 59.930206],
              [30.388997, 59.92978],
              [30.388975, 59.929625],
              [30.388919, 59.929432],
              [30.388868, 59.929236],
              [30.388831, 59.928999],
              [30.388814, 59.928832],
              [30.388814, 59.928581],
              [30.388841, 59.928393],
              [30.38893, 59.927944],
              [30.389016, 59.927589],
              [30.389081, 59.927382],
              [30.3892, 59.927035],
              [30.389394, 59.926619],
              [30.389654, 59.926174],
              [30.390305, 59.925204],
              [30.390883, 59.924348],
              [30.391032, 59.924141],
              [30.391257, 59.923895],
              [30.39163, 59.923315],
              [30.391726, 59.923167],
              [30.392349, 59.922245],
              [30.392409, 59.922156],
              [30.392508, 59.922035],
              [30.392945, 59.921665],
              [30.394419, 59.920841],
              [30.395509, 59.920231],
              [30.396676, 59.919582],
              [30.396989, 59.919415],
              [30.397387, 59.919191],
              [30.397728, 59.918998],
              [30.398278, 59.918691],
              [30.398829, 59.91838],
              [30.398971, 59.9183],
              [30.399399, 59.91806],
              [30.400358, 59.91754],
              [30.400447, 59.917491],
              [30.400809, 59.917296],
              [30.40096, 59.917203],
              [30.401069, 59.917127],
              [30.40132, 59.916909],
              [30.401764, 59.91649],
              [30.402759, 59.91557],
              [30.403498, 59.914882],
              [30.403564, 59.914821],
              [30.404093, 59.914318],
              [30.404405, 59.914025],
              [30.404525, 59.913925],
              [30.404696, 59.913808],
              [30.405029, 59.91359],
              [30.405555, 59.913216],
              [30.40621, 59.912753],
              [30.406889, 59.91227],
              [30.407628, 59.911743],
              [30.407741, 59.911664],
              [30.407848, 59.911592],
              [30.408178, 59.911401],
              [30.408661, 59.911165],
              [30.408915, 59.911044],
              [30.409746, 59.910649],
              [30.409913, 59.910565],
              [30.41131, 59.909905],
              [30.412202, 59.909485],
              [30.413287, 59.908971],
              [30.413896, 59.908681],
              [30.414135, 59.908565],
              [30.414341, 59.908452],
              [30.414448, 59.908387],
              [30.414912, 59.908103],
              [30.416514, 59.907119],
              [30.417388, 59.906581],
              [30.417927, 59.906249],
              [30.418031, 59.906186],
              [30.418428, 59.905941],
              [30.418588, 59.905843],
              [30.419039, 59.905566],
              [30.419118, 59.905519],
              [30.4192, 59.905469],
              [30.419547, 59.905256],
              [30.420069, 59.904938],
              [30.420835, 59.904492],
              [30.421002, 59.904396],
              [30.421371, 59.904186],
              [30.42245, 59.903525],
              [30.423054, 59.903162],
              [30.423186, 59.903077],
              [30.423557, 59.902846],
              [30.423765, 59.902718],
              [30.423972, 59.902593],
              [30.42424, 59.90243],
              [30.424709, 59.902142],
              [30.424794, 59.90209],
              [30.425207, 59.901838],
              [30.42562, 59.901586],
              [30.425809, 59.901469],
              [30.426863, 59.900824],
              [30.427074, 59.900695],
              [30.428001, 59.900128],
              [30.428132, 59.900047],
              [30.428677, 59.899711],
              [30.428916, 59.899565],
              [30.429685, 59.899095],
              [30.429818, 59.899013],
              [30.43023, 59.898763],
              [30.430399, 59.898658],
              [30.430512, 59.898588],
              [30.431462, 59.898002],
              [30.431501, 59.897979],
              [30.432127, 59.897597],
              [30.432467, 59.897387],
              [30.432548, 59.897339],
              [30.433129, 59.896984],
              [30.43326, 59.8969],
              [30.433756, 59.896596],
              [30.433966, 59.896468],
              [30.43493, 59.895876],
              [30.435617, 59.895456],
              [30.436443, 59.894947],
              [30.436758, 59.894741],
              [30.436625, 59.894714],
              [30.436328, 59.894658],
              [30.43542, 59.894484],
              [30.43482, 59.894365],
              [30.433644, 59.894136],
              [30.432971, 59.894005],
              [30.432418, 59.893897],
              [30.432057, 59.893829],
              [30.432, 59.893902],
              [30.431909, 59.894021],
              [30.431734, 59.894154],
              [30.431585, 59.894349],
              [30.431506, 59.894368],
              [30.43106, 59.894281],
              [30.43102, 59.894222],
              [30.431148, 59.894062],
            ],
          },
        },
      ],
    },
    name: 'SaintPetersburg',
  },
  {
    id: 4,
    route: {
      type: 'FeatureCollection',
      features: [
        {
          type: 'Feature',
          properties: {},
          geometry: {
            type: 'LineString',
            coordinates: [
              [131.869015, 43.096411],
              [131.868967, 43.096432],
              [131.868857, 43.096474],
              [131.868759, 43.096511],
              [131.868224, 43.096721],
              [131.868118, 43.096761],
              [131.868034, 43.096774],
              [131.867851, 43.096776],
              [131.867768, 43.096764],
              [131.867605, 43.09673],
              [131.867405, 43.096678],
              [131.867288, 43.096646],
              [131.867196, 43.096633],
              [131.86712, 43.096635],
              [131.867021, 43.09666],
              [131.867017, 43.096696],
              [131.867025, 43.096736],
              [131.86698, 43.096746],
              [131.866936, 43.096758],
              [131.866718, 43.09685],
              [131.866643, 43.096879],
              [131.866471, 43.096947],
              [131.866181, 43.097043],
              [131.86593, 43.097127],
              [131.865226, 43.097362],
              [131.86499, 43.097277],
              [131.864717, 43.097163],
              [131.864344, 43.097],
              [131.86413, 43.096916],
              [131.863742, 43.096766],
              [131.863643, 43.096721],
              [131.863482, 43.096633],
              [131.863136, 43.096402],
              [131.862673, 43.096057],
              [131.862309, 43.095772],
              [131.862237, 43.09572],
              [131.862215, 43.095706],
              [131.862043, 43.095588],
              [131.861937, 43.095516],
              [131.861677, 43.095763],
              [131.861584, 43.095866],
              [131.861504, 43.095966],
              [131.861451, 43.096046],
              [131.861398, 43.096166],
              [131.861316, 43.096355],
              [131.861112, 43.096918],
              [131.861087, 43.096992],
              [131.861094, 43.097057],
              [131.86112, 43.097127],
              [131.861195, 43.097228],
              [131.861397, 43.097392],
              [131.861808, 43.097721],
              [131.862142, 43.098008],
              [131.862271, 43.098116],
              [131.862318, 43.098155],
              [131.862381, 43.098208],
              [131.862634, 43.098419],
              [131.862657, 43.098439],
              [131.8629, 43.09864],
              [131.863015, 43.098733],
              [131.863133, 43.098824],
              [131.86336, 43.098993],
              [131.863763, 43.09928],
              [131.863819, 43.099314],
              [131.863851, 43.099331],
              [131.863891, 43.099355],
              [131.864142, 43.099476],
              [131.864281, 43.099544],
              [131.864356, 43.09958],
              [131.86448, 43.099647],
              [131.864795, 43.099804],
              [131.86503, 43.099937],
              [131.866262, 43.100721],
              [131.866465, 43.100854],
              [131.866717, 43.101026],
              [131.866829, 43.101101],
              [131.868007, 43.101934],
              [131.868454, 43.102258],
              [131.86905, 43.102656],
              [131.869214, 43.102766],
              [131.869298, 43.102822],
              [131.869439, 43.102916],
              [131.869781, 43.10315],
              [131.869824, 43.103179],
              [131.869862, 43.103205],
              [131.870017, 43.103312],
              [131.870238, 43.103467],
              [131.870431, 43.103604],
              [131.870904, 43.103927],
              [131.871116, 43.104076],
              [131.871593, 43.104403],
              [131.871662, 43.104449],
              [131.872635, 43.104904],
              [131.872798, 43.104973],
              [131.873348, 43.10523],
              [131.873415, 43.105257],
              [131.873491, 43.105283],
              [131.873566, 43.105311],
              [131.873863, 43.105421],
              [131.874116, 43.105359],
              [131.874323, 43.105358],
              [131.8744, 43.105368],
              [131.874493, 43.105393],
              [131.875884, 43.10583],
              [131.876466, 43.106075],
              [131.877412, 43.106656],
              [131.877441, 43.106673],
              [131.877839, 43.10691],
              [131.878436, 43.107327],
              [131.878954, 43.107759],
              [131.880058, 43.108704],
              [131.880118, 43.108838],
              [131.880492, 43.110086],
              [131.880612, 43.110485],
              [131.880635, 43.110558],
              [131.880656, 43.110632],
              [131.880665, 43.110672],
              [131.880682, 43.110731],
              [131.88069, 43.110761],
              [131.880727, 43.110945],
              [131.880767, 43.111148],
              [131.880782, 43.111211],
              [131.880919, 43.111732],
              [131.880948, 43.111848],
              [131.880971, 43.111942],
              [131.880977, 43.11196],
              [131.881135, 43.112468],
              [131.88123, 43.11277],
              [131.88135, 43.113152],
              [131.881416, 43.113361],
              [131.881423, 43.113382],
              [131.881756, 43.11428],
              [131.881884, 43.114659],
              [131.882022, 43.11507],
              [131.882028, 43.115089],
              [131.88206, 43.115183],
              [131.88207, 43.115212],
              [131.882085, 43.115256],
              [131.882113, 43.11534],
              [131.882142, 43.115427],
              [131.882146, 43.115438],
              [131.88217, 43.115511],
              [131.882203, 43.115609],
              [131.882273, 43.115817],
              [131.882368, 43.116099],
              [131.882444, 43.116306],
              [131.883367, 43.11613],
              [131.88391, 43.116027],
              [131.884412, 43.115931],
              [131.884645, 43.115887],
              [131.884814, 43.115854],
              [131.884971, 43.115825],
              [131.885493, 43.115725],
              [131.885649, 43.11616],
              [131.885764, 43.116484],
              [131.885916, 43.11691],
              [131.885924, 43.116932],
              [131.886157, 43.117586],
              [131.886198, 43.1177],
              [131.886297, 43.117977],
              [131.886316, 43.118029],
              [131.886456, 43.118003],
              [131.886962, 43.117907],
              [131.887266, 43.117849],
              [131.887425, 43.117819],
              [131.887627, 43.117781],
              [131.887943, 43.117721],
              [131.888048, 43.117701],
              [131.888538, 43.117606],
              [131.888695, 43.117578],
              [131.889039, 43.117516],
              [131.889527, 43.11762],
              [131.889629, 43.117641],
              [131.889672, 43.11765],
              [131.889993, 43.117718],
              [131.890129, 43.117747],
              [131.890313, 43.117786],
              [131.890348, 43.117793],
              [131.890652, 43.117858],
              [131.89067, 43.117862],
              [131.890786, 43.11783],
              [131.890816, 43.117821],
              [131.890848, 43.117818],
              [131.890881, 43.117821],
              [131.890898, 43.117825],
              [131.891273, 43.117793],
              [131.891484, 43.117754],
              [131.891995, 43.11766],
              [131.892215, 43.117611],
              [131.892301, 43.117592],
              [131.892641, 43.117525],
              [131.892881, 43.117475],
              [131.893051, 43.11744],
              [131.893209, 43.117404],
              [131.893245, 43.117396],
              [131.893356, 43.117371],
              [131.893608, 43.117319],
              [131.894133, 43.11721],
              [131.894157, 43.117204],
              [131.894801, 43.117071],
              [131.895065, 43.117019],
              [131.895486, 43.11694],
              [131.895926, 43.116863],
              [131.896247, 43.116815],
              [131.896392, 43.116761],
              [131.896517, 43.116695],
              [131.896558, 43.116661],
              [131.8966, 43.116611],
              [131.896666, 43.116545],
              [131.896692, 43.116502],
              [131.896705, 43.116467],
              [131.89661, 43.116253],
              [131.896543, 43.116053],
              [131.896399, 43.11563],
              [131.896342, 43.115303],
              [131.896366, 43.114985],
              [131.896366, 43.11483],
              [131.896325, 43.112891],
              [131.896292, 43.111323],
              [131.896234, 43.10855],
              [131.896183, 43.106102],
              [131.896112, 43.102722],
              [131.896084, 43.102599],
              [131.896052, 43.102501],
              [131.895984, 43.102394],
              [131.895902, 43.102312],
              [131.895768, 43.102229],
              [131.895612, 43.102164],
              [131.895097, 43.101982],
              [131.894824, 43.101884],
              [131.894686, 43.101824],
              [131.89457, 43.101758],
              [131.894368, 43.101605],
              [131.894282, 43.101519],
              [131.894073, 43.101304],
              [131.893977, 43.101205],
              [131.893941, 43.101168],
              [131.893853, 43.101079],
              [131.893811, 43.101036],
              [131.893804, 43.101029],
              [131.893691, 43.100917],
              [131.893516, 43.100736],
              [131.893134, 43.100327],
              [131.892898, 43.100072],
              [131.89284, 43.100014],
              [131.892739, 43.09991],
              [131.892634, 43.099794],
              [131.892621, 43.099781],
              [131.892598, 43.099756],
              [131.892527, 43.099679],
              [131.892234, 43.099362],
              [131.89215, 43.099273],
              [131.892122, 43.099243],
              [131.892026, 43.09914],
              [131.89199, 43.099099],
              [131.891855, 43.098945],
              [131.891836, 43.098924],
              [131.891651, 43.098721],
              [131.891413, 43.098472],
              [131.891247, 43.098333],
              [131.891017, 43.098157],
              [131.890486, 43.097751],
              [131.890233, 43.097566],
              [131.889832, 43.097285],
              [131.889607, 43.097124],
              [131.889534, 43.097074],
              [131.889392, 43.096967],
              [131.888844, 43.096569],
              [131.888758, 43.096507],
              [131.888486, 43.096296],
              [131.88802, 43.095963],
              [131.888049, 43.095897],
              [131.888069, 43.095853],
              [131.888087, 43.095784],
              [131.888124, 43.095677],
              [131.888283, 43.095512],
              [131.888357, 43.095447],
              [131.888448, 43.095384],
              [131.888498, 43.095359],
              [131.888753, 43.09525],
              [131.888862, 43.095212],
              [131.888986, 43.095171],
              [131.889123, 43.095133],
              [131.889305, 43.095097],
              [131.889371, 43.095087],
              [131.889307, 43.095254],
              [131.889287, 43.095296],
              [131.889256, 43.095382],
              [131.889247, 43.095473],
              [131.889265, 43.095624],
            ],
          },
        },
      ],
    },
    name: 'Vladivostok',
  },
];

const pointsAnnotationCreate = (geo) => {
  const g = geo.features.filter((f) => f.geometry.type === 'Point');

  const s = {
    type: 'FeatureCollection',
    features: [...g],
  };
  return (
    <MapboxGL.ShapeSource id="exampleShapeSource" shape={s}>
      <MapboxGL.SymbolLayer
        onPress={(e) => console.log(e)}
        id="exampleIconName"
        style={styles.icon}
      />
    </MapboxGL.ShapeSource>
  );
  // return geo.features
  //   .filter((f) => f.geometry.type === 'Point')
  //   .map((p) => (
  //     <MapboxGL.PointAnnotation
  //       id={p.properties.Sys.toString()}
  //       coordinate={p.geometry.coordinates}
  //     />
  //   ));
};

export default Map;
